<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html>

<head>
<meta http-equiv="content-type" content="text/html;charset=Shift_JIS">
<title>杉本電気システムソリューション</title>
<link href="../css/common.css" rel="stylesheet" media="all">
<link href="../css/dummy.css?ver=20200307"rel="stylesheet" media="all">
<script src='https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js'></script>
<style>li.L0,li.L1,li.L2,li.L3,li.L5,li.L6,li.L7,li.L8{list-style-type:decimal}</style>
</head>

<body>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/ja_JP/sdk.js#xfbml=1&version=v2.9&appId=962202797129668";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div id="wrap">


<!--ヘッダエリア-->
<div id="head">
<table width="760" border="0" cellspacing="0" cellpadding="0">
<tr>
<th><a href="../index.html">杉本電気システムソリューション</a></th>
<td>
<em id="tel">090-0000-0000</em>
<em id="form"><a href="../question.html"><img src="../images/form.jpg" alt="お問い合わせフォーム" height="25" width="167" border="0"></a></em>
</td>
</tr>
</table>
</div>
<!--/ヘッダエリア-->

<!--コンテンツエリア-->
<div id="cont">
<table width="760" border="0" cellspacing="0" cellpadding="0">
<tr>
<!--サイドメニュー-->
<td valign="top" id="menu">
<ul>
<li><a href="../index.html">トップページ</a></li>
<li><a href="../about.html">杉本電気システムソリューションについて</a></li>
<li><a href="../item.html">取扱システム一覧</a></li>
<li><a href="../appliitem.html">アプリ製品一覧</a></li>
<li><a href="../profile.html">組織概要</a></li>
<li><a href="#">PLCとは</a>
<ul>
<li><a href="../plc/plc.html">PLC概要</a></li>
<li><a href="../plc/hard.html">電気図面</a></li>
<li><a href="../plc/ladder.html">ラダー・ロジックとは</a></li>
<li><a href="../plc/servo.html">サーボ</a></li>
</ul>
</li>
<li><a href="../technology.html">PLCとITの連携技術</a></li>
<li><a href="../note.html">備忘録</a></li>
<li><a href="../question.html">お問い合わせフォーム</a></li>
</ul>
<address>
杉本電気システムソリューション<br />
〒<br />
大阪府堺市北区<br />
電話：090-0000-0000<br />
<div style="padding: 3px" >
<a href="https://www.facebook.com/profile.php?id=100007404393215" TARGET="_blank"><img src="../images/Japanese_FB_FindUsOnFacebook-100.png" alt="FaceBook" height="35" width="120"></a>
</div >
<div style="padding: 3px" >
<a href="japanseiha.html" TARGET="_blank"><img src="images/JapanSeiha.png" alt="JapanSeiha" height="35" width="120"></a>
</div >
<div style="padding: 3px" >
<a href="http://www.osakanight.com/" TARGET="_blank"><img src="../images/osakayakei.gif" alt="OsakaYakei" height="35" width="120"></a>
</div >
<div style="padding: 3px" >
<a href="https://www.youtube.com/channel/UCxW7BrxY6XsdRRUEa_OpYIA" TARGET="_blank"><img src="../images/YouTube-logo-full_color.png" alt="YouTube" height="50" width="120"></a>
</div >
<div style="padding: 3px" >
<a href="https://www.instagram.com/takuya6480/?hl=ja" TARGET="_blank"><img src="images/Instagram_AppIcon.png" alt="Instagram" height="50" width="120"></a>
</div >
</address>
</td>
<!--/サイドメニュー-->

<!--メイン-->
<td valign="top" width="570" id="main">

<div id="ctitle">
<h3>MCプロトコルとは</h3>
</div>

<div id="lead">
<h4>MCプロトコルとは「MELSEC コミュニケーションプロトコル」のことで、
Ethernetポートを介してデバイスデータ読み出し／書き込みをおこなうための
三菱電機㈱製PLC専用の通信方式です。
</h4>
<div class="img_r">
<img src="../images/IOT_Free.jpg" alt="" height="160" width="220" border="0">
<p>IOTのイメージ</p>
</div>
<div class="explanation">
<p>
よくテレビ等でIOT(モノのインターネット：Internet of Things）が叫ばれ、今や工場システムでも
サーバーやスマフォとの通信は必須になってきています。
</p>
<p>
ＰＣとＰＬＣの通信は
<a href="technology.html" TARGET="_blank">PLCとITの連携技術</a>でも紹介している通り、
各メーカーで販売されているライブラリを使用する方法もあります。
</p>
<p>
メリットとして大幅な工数削減ができますが、当然各メーカーのＤＬＬに左右され、64bitアプリでは使えないとか、
そもそもスマフォやハンディアプリからは使えないといったデメリットがあります。
</p>
<p>
三菱電機㈱では、PLCやタッチパネルから直接データベースにデータ操作できるMESインターフェースを
用意しており、筆者は最初その技術を使おうと考え三菱電機㈱に問い合わせました。
</p>
<p>
しかしながら数十万円のサーバーライセンスや特殊ユニットが必要で、
しかも柔軟な通信システムが構築できないことが判明し、<br/>
<div style="font-weight: bolder;font-size: large;">「もうええわ」（和牛のギャグ）</div><br/>
となってしまいました。
</p>
<p>
※和牛のギャグ「もうええわ」が分からない方はこちらの動画をどうぞ。<br>
<a href="https://www.youtube.com/watch?v=TWQ3tiGvAI0" TARGET="_blank">【和牛】「漫才の いろんな もうええわw」</a>
</p>
<p></p>
</div>

<h3>
。。。ということで、MCプロトコルを使用します
</h3>

<div class="explanation">
<p>
MCプロトコルの内容は
<a href="http://www.takach.net/pc/melsec_socket.html" TARGET="_blank">Perlで三菱シーケンサーとSocket通信</a>
に詳しく記載されています。Perl言語のプログラムですが、プログラム内容は他言語のソケット通信でも流用可能です。
</p>

<p>
VB.NETのプログラムは
<a href="https://qiita.com/yuki_fr_knct/items/decad4a3fcb47320da17" TARGET="_blank">
(MX Component を使わない) MCプロトコル によるPLC Ether通信(VB.NET)</a>
にもあります。
</p>

<p>
<div style="font-weight: bolder;font-size: medium;">
MCプロトコル による通信は三菱PLCのみならず、キーエンスPLCとも接続可能です。
筆者もハンディアプリとPLCの通信システムで使用しています。
</div>
</p>

<h3>
自作で、MCプロトコル通信クラス作成してみました！！
</h3>

<p>
<div style="font-weight: bolder;font-size: medium;">
VB.NETアプリ用のクラスにまとめたMCプロトコル通信プログラムを自作しました。</br>
※三菱PLCと接続確認済みです。
</div>
</p>

<p>
GitHubで公開しています。</br>
<a href="https://github.com/sugimoto0614/MCProtocol.git" TARGET="_blank">
https://github.com/sugimoto0614/MCProtocol.git</a>
</p>

<p>
GitHubを使わない方はこちらからもダウンロードできます。</br>
<a href="PLCDataReader.txt" download="PLCDataReader.txt">PLCDataReaderクラスのダウンロード</a>
</p>
</br>
<p>
※連続領域のデータメモリからデータ取得をしたいときは、
MakeContinueData()関数を使用してください。
離散領域はMakeDiscreteData()関数を使用して下さい。
</p>

<p>
※連続領域のデータメモリは112行目でD300に固定していますので、
書き換えてください。
離散領域のデータメモリ番号は34行目のmDeviceNameArray配列の中身を変更下さい。
</p>

<p>
※通信先PLCのIPアドレスは、42行目を変更下さい。
</p>

<p>
通常のソケット通信機能を使っていますので、AndroidやiPhoneアプリからも
ソケット通信クラスでコマンドを送受信すればMCプロトコルは使えます。
通信ソフトを作りたいと考えている方は試してみてはいかがでしょうか。
</p>
</div>

</div>
</div>

<div class="fb-like" data-href="http://sugielectric.php.xdomain.jp/noteMC.html" data-layout="button_count" data-action="like" data-size="small" data-show-faces="true" data-share="true"></div>

<!--コピーライト-->
<div id="copyright">
Produced by <a href="http://www.dimbula.jp" target="_blank">無料でホームページを作成</a>しよう
</div>
<!--/コピーライト-->



</td>
<!--/メイン-->
</tr>
</table>
</div>
<!--/コンテンツエリア-->




</div>
</body>

</html>